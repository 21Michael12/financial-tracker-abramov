<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>××¢×¨×›×ª ××¢×§×‘ ×¤×™× × ×¡×™ - ×¢× ×¡× ×›×¨×•×Ÿ ×¢× ×Ÿ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .sync-status {
            background: rgba(255,255,255,0.2);
            padding: 10px 20px;
            border-radius: 20px;
            display: inline-block;
            margin-top: 10px;
        }

        .sync-status.synced {
            background: rgba(67, 233, 123, 0.3);
        }

        .sync-status.syncing {
            background: rgba(255, 193, 7, 0.3);
        }

        .auth-section {
            background: #f8f9fa;
            padding: 30px;
            text-align: center;
        }

        .auth-section input {
            padding: 15px;
            margin: 10px;
            border: 2px solid #667eea;
            border-radius: 8px;
            font-size: 1em;
            width: 300px;
            max-width: 90%;
        }

        .tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 2px solid #e0e0e0;
        }

        .tab {
            flex: 1;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: bold;
            transition: all 0.3s;
            border: none;
            background: transparent;
        }

        .tab:hover {
            background: #e9ecef;
        }

        .tab.active {
            background: white;
            color: #667eea;
            border-bottom: 3px solid #667eea;
        }

        .content {
            padding: 30px;
        }

        .content-hidden {
            display: none;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .month-selector {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .month-selector label {
            font-weight: bold;
            font-size: 1.1em;
        }

        .month-selector select {
            padding: 10px 15px;
            border: 2px solid #667eea;
            border-radius: 8px;
            font-size: 1em;
            cursor: pointer;
        }

        .form-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .form-section h3 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.5em;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #333;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .form-group textarea {
            resize: vertical;
            min-height: 80px;
        }

        .sub-category {
            background: white;
            padding: 20px;
            margin: 15px 0;
            border-radius: 8px;
            border-right: 4px solid #667eea;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1.1em;
            cursor: pointer;
            transition: transform 0.2s;
            font-weight: bold;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #6c757d;
        }

        .summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .summary-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 10px;
            text-align: center;
        }

        .summary-card h4 {
            font-size: 1em;
            margin-bottom: 10px;
            opacity: 0.9;
        }

        .summary-card .amount {
            font-size: 2em;
            font-weight: bold;
        }

        .chart-container {
            margin-top: 30px;
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
        }

        .chart-container h3 {
            color: #667eea;
            margin-bottom: 20px;
            text-align: center;
        }

        canvas {
            max-width: 100%;
            height: auto !important;
        }

        .months-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 20px;
        }

        .month-badge {
            background: #667eea;
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            font-weight: bold;
        }

        .expense-details {
            margin-top: 30px;
        }

        .expense-item {
            background: white;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border-right: 4px solid #764ba2;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .expense-item strong {
            color: #667eea;
        }

        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 30px;
            margin-top: 30px;
        }

        .expense-entry {
            background: white;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border: 2px solid #e0e0e0;
            position: relative;
        }

        .expense-entry-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .remove-btn {
            background: #f5576c;
            color: white;
            border: none;
            padding: 5px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9em;
        }

        .remove-btn:hover {
            background: #e04555;
        }

        .add-entry-btn {
            background: #43e97b;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            margin-top: 10px;
            width: 100%;
        }

        .add-entry-btn:hover {
            background: #38d66a;
        }

        .sub-category-title {
            background: #667eea;
            color: white;
            padding: 15px;
            border-radius: 8px 8px 0 0;
            font-weight: bold;
            font-size: 1.1em;
        }

        .entries-container {
            padding: 15px;
            background: #fafafa;
        }

        .category-total {
            background: #667eea;
            color: white;
            padding: 10px 15px;
            border-radius: 0 0 8px 8px;
            font-weight: bold;
            text-align: left;
        }

        @media (max-width: 768px) {
            .charts-grid {
                grid-template-columns: 1fr;
            }
        }

        .setup-instructions {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .setup-instructions h3 {
            color: #856404;
            margin-bottom: 15px;
        }

        .setup-instructions ol {
            margin-right: 20px;
        }

        .setup-instructions li {
            margin: 10px 0;
            line-height: 1.6;
        }

        .setup-instructions code {
            background: #f8f9fa;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ’° ××¢×¨×›×ª ××¢×§×‘ ×¤×™× × ×¡×™</h1>
            <p>× ×”×œ ××ª ×”×›×¡×¤×™× ×©×œ×š ×‘×¦×•×¨×” ×—×›××” ×•×™×¢×™×œ×” - ×¢× ×¡× ×›×¨×•×Ÿ ×‘×¢× ×Ÿ</p>
            <div class="sync-status" id="syncStatus">
                <span id="syncText">ğŸ”„ ×××ª×™×Ÿ ×œ×—×™×‘×•×¨...</span>
            </div>
        </div>

        <!-- Auth Section -->
        <div id="authSection" class="auth-section">
            <h2>ğŸ” ×”×ª×—×‘×¨×•×ª / ×”×™×¨×©×</h2>
            <p style="margin: 15px 0;">×›×“×™ ×œ×¡× ×›×¨×Ÿ × ×ª×•× ×™× ×‘×™×Ÿ ××›×©×™×¨×™×, ×× × ×”×ª×—×‘×¨ ××• ×”×™×¨×©×</p>
            <div>
                <input type="email" id="emailInput" placeholder="××™××™×™×œ" />
                <input type="password" id="passwordInput" placeholder="×¡×™×¡××”" />
            </div>
            <div style="margin-top: 15px;">
                <button class="btn" onclick="signIn()">×”×ª×—×‘×¨</button>
                <button class="btn btn-secondary" onclick="signUp()">×”×™×¨×©×</button>
            </div>
            <div id="authError" style="color: red; margin-top: 15px;"></div>
        </div>

        <div class="tabs content-sections" style="display: none;">
            <button class="tab active" onclick="showTab('income')">×”×›× ×¡×•×ª</button>
            <button class="tab" onclick="showTab('expenses')">×”×•×¦××•×ª</button>
            <button class="tab" onclick="showTab('dashboard')">×œ×•×— ×‘×§×¨×”</button>
        </div>

        <div class="content">
            <!-- Month Selector -->
            <div class="month-selector content-sections" style="display: none;">
                <label>×‘×—×¨ ×—×•×“×©:</label>
                <select id="monthSelectDropdown" onchange="updateMonth()">
                    <option value="">-- ×‘×—×¨ ×—×•×“×© ×§×™×™× --</option>
                </select>
                <span style="margin: 0 20px; font-weight: bold;">××•</span>
                <label>×¦×•×¨ ×—×•×“×© ×—×“×©:</label>
                <select id="yearSelect">
                    <option value="">×‘×—×¨ ×©× ×”</option>
                </select>
                <select id="monthSelect">
                    <option value="">×‘×—×¨ ×—×•×“×©</option>
                    <option value="01">×™× ×•××¨</option>
                    <option value="02">×¤×‘×¨×•××¨</option>
                    <option value="03">××¨×¥</option>
                    <option value="04">××¤×¨×™×œ</option>
                    <option value="05">×××™</option>
                    <option value="06">×™×•× ×™</option>
                    <option value="07">×™×•×œ×™</option>
                    <option value="08">××•×’×•×¡×˜</option>
                    <option value="09">×¡×¤×˜××‘×¨</option>
                    <option value="10">××•×§×˜×•×‘×¨</option>
                    <option value="11">× ×•×‘××‘×¨</option>
                    <option value="12">×“×¦××‘×¨</option>
                </select>
                <button class="btn" onclick="addNewMonth()">×¦×•×¨ ×—×•×“×©</button>
                <button class="btn btn-secondary" onclick="signOut()" style="margin-right: auto;">×”×ª× ×ª×§</button>
            </div>

            <div class="content-sections" id="mainContent" style="display: none;">
            <!-- Income Tab -->
            <div id="income" class="tab-content active">
                <div class="form-section">
                    <h3>ğŸ“ˆ ×”×›× ×¡×•×ª</h3>
                    
                    <div class="sub-category">
                        <div class="form-group">
                            <label>×™×ª×¨×” ×‘×¢×•"×©</label>
                            <input type="number" id="income-balance" placeholder="×¡×›×•×" />
                            <textarea id="income-balance-desc" placeholder="×ª×™××•×¨"></textarea>
                        </div>
                    </div>

                    <div class="sub-category">
                        <div class="form-group">
                            <label>×©×›×¨ ×¢×‘×•×“×”</label>
                            <input type="number" id="income-salary" placeholder="×¡×›×•×" />
                            <textarea id="income-salary-desc" placeholder="×ª×™××•×¨"></textarea>
                        </div>
                    </div>

                    <div class="sub-category">
                        <div class="form-group">
                            <label>××—×¨</label>
                            <input type="number" id="income-other" placeholder="×¡×›×•×" />
                            <textarea id="income-other-desc" placeholder="×ª×™××•×¨"></textarea>
                        </div>
                    </div>

                    <button class="btn" onclick="saveIncome()">×©××•×¨ ×”×›× ×¡×•×ª</button>
                </div>
            </div>

            <!-- Expenses Tab -->
            <div id="expenses" class="tab-content">
                <div class="form-section">
                    <h3>ğŸ’³ ×”×ª×—×™×™×‘×•×™×•×ª - ×›×¨×˜×™×¡ ××©×¨××™ 1 (×××¨×™×§×Ÿ ××§×¡×¤×¨×¡)</h3>
                    
                    <div class="sub-category">
                        <div class="sub-category-title">××–×•×Ÿ ××”×™×¨</div>
                        <div class="entries-container" id="amex-fastfood-entries"></div>
                        <button class="add-entry-btn" onclick="addExpenseEntry('amex-fastfood')">+ ×”×•×¡×£ ×”×•×¦××”</button>
                        <div class="category-total" id="amex-fastfood-total">×¡×”"×›: â‚ª0</div>
                    </div>

                    <div class="sub-category">
                        <div class="sub-category-title">×‘×’×“×™× ×•×§× ×™×•×ª ××•×¤× ×”</div>
                        <div class="entries-container" id="amex-fashion-entries"></div>
                        <button class="add-entry-btn" onclick="addExpenseEntry('amex-fashion')">+ ×”×•×¡×£ ×”×•×¦××”</button>
                        <div class="category-total" id="amex-fashion-total">×¡×”"×›: â‚ª0</div>
                    </div>

                    <div class="sub-category">
                        <div class="sub-category-title">×§× ×™×•×ª ×¨×’×™×œ×•×ª (×¡×•×¤×¨×™×, ×¡×•×¤×¨ ×¤××¨× ×•×›×•')</div>
                        <div class="entries-container" id="amex-regular-entries"></div>
                        <button class="add-entry-btn" onclick="addExpenseEntry('amex-regular')">+ ×”×•×¡×£ ×”×•×¦××”</button>
                        <div class="category-total" id="amex-regular-total">×¡×”"×›: â‚ª0</div>
                    </div>

                    <div class="sub-category">
                        <div class="sub-category-title">×™×¦×™××•×ª ×•×‘×™×œ×•×™×™×</div>
                        <div class="entries-container" id="amex-entertainment-entries"></div>
                        <button class="add-entry-btn" onclick="addExpenseEntry('amex-entertainment')">+ ×”×•×¡×£ ×”×•×¦××”</button>
                        <div class="category-total" id="amex-entertainment-total">×¡×”"×›: â‚ª0</div>
                    </div>

                    <div class="sub-category">
                        <div class="sub-category-title">×ª×©×œ×•××™ ×¨×›×‘ ×©×•×˜×¤×™×</div>
                        <div class="entries-container" id="amex-car-entries"></div>
                        <button class="add-entry-btn" onclick="addExpenseEntry('amex-car')">+ ×”×•×¡×£ ×”×•×¦××”</button>
                        <div class="category-total" id="amex-car-total">×¡×”"×›: â‚ª0</div>
                    </div>

                    <div class="sub-category">
                        <div class="sub-category-title">×‘×™×˜×•×—×™× ×©×•×˜×¤×™×</div>
                        <div class="entries-container" id="amex-insurance-entries"></div>
                        <button class="add-entry-btn" onclick="addExpenseEntry('amex-insurance')">+ ×”×•×¡×£ ×”×•×¦××”</button>
                        <div class="category-total" id="amex-insurance-total">×¡×”"×›: â‚ª0</div>
                    </div>

                    <div class="sub-category">
                        <div class="sub-category-title">×©×™×¨×•×ª×™× ×•××™× ×•×™×™×</div>
                        <div class="entries-container" id="amex-subscriptions-entries"></div>
                        <button class="add-entry-btn" onclick="addExpenseEntry('amex-subscriptions')">+ ×”×•×¡×£ ×”×•×¦××”</button>
                        <div class="category-total" id="amex-subscriptions-total">×¡×”"×›: â‚ª0</div>
                    </div>

                    <div class="sub-category">
                        <div class="sub-category-title">××—×¨</div>
                        <div class="entries-container" id="amex-other-entries"></div>
                        <button class="add-entry-btn" onclick="addExpenseEntry('amex-other')">+ ×”×•×¡×£ ×”×•×¦××”</button>
                        <div class="category-total" id="amex-other-total">×¡×”"×›: â‚ª0</div>
                    </div>
                </div>

                <div class="form-section">
                    <h3>ğŸ’³ ×”×ª×—×™×™×‘×•×™×•×ª - ×›×¨×˜×™×¡ ××©×¨××™ 2 (×××¡×˜×¨×§××¨×“)</h3>
                    
                    <div class="sub-category">
                        <div class="sub-category-title">××–×•×Ÿ ××”×™×¨</div>
                        <div class="entries-container" id="mastercard-fastfood-entries"></div>
                        <button class="add-entry-btn" onclick="addExpenseEntry('mastercard-fastfood')">+ ×”×•×¡×£ ×”×•×¦××”</button>
                        <div class="category-total" id="mastercard-fastfood-total">×¡×”"×›: â‚ª0</div>
                    </div>

                    <div class="sub-category">
                        <div class="sub-category-title">×‘×’×“×™× ×•×§× ×™×•×ª ××•×¤× ×”</div>
                        <div class="entries-container" id="mastercard-fashion-entries"></div>
                        <button class="add-entry-btn" onclick="addExpenseEntry('mastercard-fashion')">+ ×”×•×¡×£ ×”×•×¦××”</button>
                        <div class="category-total" id="mastercard-fashion-total">×¡×”"×›: â‚ª0</div>
                    </div>

                    <div class="sub-category">
                        <div class="sub-category-title">×§× ×™×•×ª ×¨×’×™×œ×•×ª (×¡×•×¤×¨×™×, ×¡×•×¤×¨ ×¤××¨× ×•×›×•')</div>
                        <div class="entries-container" id="mastercard-regular-entries"></div>
                        <button class="add-entry-btn" onclick="addExpenseEntry('mastercard-regular')">+ ×”×•×¡×£ ×”×•×¦××”</button>
                        <div class="category-total" id="mastercard-regular-total">×¡×”"×›: â‚ª0</div>
                    </div>

                    <div class="sub-category">
                        <div class="sub-category-title">×™×¦×™××•×ª ×•×‘×™×œ×•×™×™×</div>
                        <div class="entries-container" id="mastercard-entertainment-entries"></div>
                        <button class="add-entry-btn" onclick="addExpenseEntry('mastercard-entertainment')">+ ×”×•×¡×£ ×”×•×¦××”</button>
                        <div class="category-total" id="mastercard-entertainment-total">×¡×”"×›: â‚ª0</div>
                    </div>

                    <div class="sub-category">
                        <div class="sub-category-title">×ª×©×œ×•××™ ×¨×›×‘ ×©×•×˜×¤×™×</div>
                        <div class="entries-container" id="mastercard-car-entries"></div>
                        <button class="add-entry-btn" onclick="addExpenseEntry('mastercard-car')">+ ×”×•×¡×£ ×”×•×¦××”</button>
                        <div class="category-total" id="mastercard-car-total">×¡×”"×›: â‚ª0</div>
                    </div>

                    <div class="sub-category">
                        <div class="sub-category-title">×‘×™×˜×•×—×™× ×©×•×˜×¤×™×</div>
                        <div class="entries-container" id="mastercard-insurance-entries"></div>
                        <button class="add-entry-btn" onclick="addExpenseEntry('mastercard-insurance')">+ ×”×•×¡×£ ×”×•×¦××”</button>
                        <div class="category-total" id="mastercard-insurance-total">×¡×”"×›: â‚ª0</div>
                    </div>

                    <div class="sub-category">
                        <div class="sub-category-title">×©×™×¨×•×ª×™× ×•××™× ×•×™×™×</div>
                        <div class="entries-container" id="mastercard-subscriptions-entries"></div>
                        <button class="add-entry-btn" onclick="addExpenseEntry('mastercard-subscriptions')">+ ×”×•×¡×£ ×”×•×¦××”</button>
                        <div class="category-total" id="mastercard-subscriptions-total">×¡×”"×›: â‚ª0</div>
                    </div>

                    <div class="sub-category">
                        <div class="sub-category-title">××—×¨</div>
                        <div class="entries-container" id="mastercard-other-entries"></div>
                        <button class="add-entry-btn" onclick="addExpenseEntry('mastercard-other')">+ ×”×•×¡×£ ×”×•×¦××”</button>
                        <div class="category-total" id="mastercard-other-total">×¡×”"×›: â‚ª0</div>
                    </div>
                </div>

                <div class="form-section">
                    <h3>ğŸ¦ × ×›×¡×™×</h3>
                    
                    <div class="sub-category">
                        <div class="sub-category-title">×”×©×›×œ×” ×•××§×¦×•×¢</div>
                        <div class="entries-container" id="assets-education-entries"></div>
                        <button class="add-entry-btn" onclick="addExpenseEntry('assets-education')">+ ×”×•×¡×£ ×”×•×¦××”</button>
                        <div class="category-total" id="assets-education-total">×¡×”"×›: â‚ª0</div>
                    </div>

                    <div class="sub-category">
                        <div class="sub-category-title">×”×©×§×¢×•×ª ×©×•×§ ×”×”×•×Ÿ</div>
                        <div class="entries-container" id="assets-investments-entries"></div>
                        <button class="add-entry-btn" onclick="addExpenseEntry('assets-investments')">+ ×”×•×¡×£ ×”×•×¦××”</button>
                        <div class="category-total" id="assets-investments-total">×¡×”"×›: â‚ª0</div>
                    </div>

                    <div class="sub-category">
                        <div class="sub-category-title">×—×¡×›×•× ×•×ª ×™×–×•××™×</div>
                        <div class="entries-container" id="assets-savings-entries"></div>
                        <button class="add-entry-btn" onclick="addExpenseEntry('assets-savings')">+ ×”×•×¡×£ ×”×•×¦××”</button>
                        <div class="category-total" id="assets-savings-total">×¡×”"×›: â‚ª0</div>
                    </div>

                    <div class="sub-category">
                        <div class="sub-category-title">×¦×™×•×“ ×©×©×•××¨ ×¢×œ ×¢×¨×š</div>
                        <div class="entries-container" id="assets-equipment-entries"></div>
                        <button class="add-entry-btn" onclick="addExpenseEntry('assets-equipment')">+ ×”×•×¡×£ ×”×•×¦××”</button>
                        <div class="category-total" id="assets-equipment-total">×¡×”"×›: â‚ª0</div>
                    </div>

                    <div class="sub-category">
                        <div class="sub-category-title">×—×“×¨ ×›×•×©×¨</div>
                        <div class="entries-container" id="assets-gym-entries"></div>
                        <button class="add-entry-btn" onclick="addExpenseEntry('assets-gym')">+ ×”×•×¡×£ ×”×•×¦××”</button>
                        <div class="category-total" id="assets-gym-total">×¡×”"×›: â‚ª0</div>
                    </div>
                </div>

                <button class="btn" onclick="saveExpenses()">×©××•×¨ ×”×•×¦××•×ª</button>
            </div>

            <!-- Dashboard Tab -->
            <div id="dashboard" class="tab-content">
                <h2 style="color: #667eea; margin-bottom: 20px;">ğŸ“Š ×œ×•×— ×‘×§×¨×”</h2>
                
                <div class="summary" id="summaryCards"></div>

                <div class="charts-grid">
                    <div class="chart-container">
                        <h3>×’×¨×£ ×¢×•×’×” - ×”×ª×¤×œ×’×•×ª ×”×•×¦××•×ª</h3>
                        <canvas id="pieChart"></canvas>
                    </div>

                    <div class="chart-container">
                        <h3>×’×¨×£ ×¢××•×“×•×ª - ×”×©×•×•××ª ×”×›× ×¡×•×ª ×•×”×•×¦××•×ª</h3>
                        <canvas id="barChart"></canvas>
                    </div>
                </div>

                <div class="chart-container">
                    <h3>×—×•×“×©×™× ×¢× × ×ª×•× ×™×</h3>
                    <div class="months-list" id="monthsList"></div>
                </div>

                <div class="expense-details" id="expenseDetails"></div>
            </div>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <script>
        // Firebase Configuration - Updated with your project details
        const firebaseConfig = {
            apiKey: "AIzaSyD4MbREsKAkYi7WL-mzi97dAT0UnL2Fm_8",
            authDomain: "abramov-finance-tracker.firebaseapp.com",
            projectId: "abramov-finance-tracker",
            storageBucket: "abramov-finance-tracker.firebasestorage.app",
            messagingSenderId: "448591919322",
            appId: "1:448591919322:web:fd2347f99bf38d60314de3",
            measurementId: "G-LP8HN170NJ"
        };

        // Initialize Firebase
        let app, auth, db;
        try {
            app = firebase.initializeApp(firebaseConfig);
            auth = firebase.auth();
            db = firebase.firestore();
            console.log("Firebase initialized successfully");
        } catch (error) {
            console.error("Firebase initialization error:", error);
            document.getElementById('syncText').textContent = 'âŒ ×©×’×™××” ×‘×—×™×‘×•×¨ - ×‘×“×•×§ ×”×’×“×¨×•×ª Firebase';
        }

        let currentUser = null;
        let data = {};
        let currentMonth = '';
        let entryCounter = 0;

        const expenseCategories = [
            'amex-fastfood', 'amex-fashion', 'amex-regular', 'amex-entertainment',
            'amex-car', 'amex-insurance', 'amex-subscriptions', 'amex-other',
            'mastercard-fastfood', 'mastercard-fashion', 'mastercard-regular', 'mastercard-entertainment',
            'mastercard-car', 'mastercard-insurance', 'mastercard-subscriptions', 'mastercard-other',
            'assets-education', 'assets-investments', 'assets-savings', 'assets-equipment', 'assets-gym'
        ];

        const monthNames = {
            '01': '×™× ×•××¨', '02': '×¤×‘×¨×•××¨', '03': '××¨×¥', '04': '××¤×¨×™×œ',
            '05': '×××™', '06': '×™×•× ×™', '07': '×™×•×œ×™', '08': '××•×’×•×¡×˜',
            '09': '×¡×¤×˜××‘×¨', '10': '××•×§×˜×•×‘×¨', '11': '× ×•×‘××‘×¨', '12': '×“×¦××‘×¨'
        };

        // Auth State Observer
        auth.onAuthStateChanged(user => {
            if (user) {
                currentUser = user;
                document.getElementById('authSection').style.display = 'none';
                document.querySelectorAll('.content-sections').forEach(el => el.style.display = 'flex');
                updateSyncStatus('synced', `âœ… ××—×•×‘×¨ ×›-${user.email}`);
                loadDataFromFirebase();
            } else {
                currentUser = null;
                document.getElementById('authSection').style.display = 'block';
                document.querySelectorAll('.content-sections').forEach(el => el.style.display = 'none');
                document.getElementById('mainContent').style.display = 'none';
                updateSyncStatus('offline', 'ğŸ”„ ×œ× ××—×•×‘×¨');
            }
        });

        function updateSyncStatus(status, text) {
            const statusEl = document.getElementById('syncStatus');
            const textEl = document.getElementById('syncText');
            statusEl.className = 'sync-status ' + status;
            textEl.textContent = text;
        }

        async function signUp() {
            const email = document.getElementById('emailInput').value;
            const password = document.getElementById('passwordInput').value;
            const errorEl = document.getElementById('authError');

            try {
                await auth.createUserWithEmailAndPassword(email, password);
                errorEl.textContent = '';
            } catch (error) {
                errorEl.textContent = '×©×’×™××”: ' + error.message;
            }
        }

        async function signIn() {
            const email = document.getElementById('emailInput').value;
            const password = document.getElementById('passwordInput').value;
            const errorEl = document.getElementById('authError');

            try {
                await auth.signInWithEmailAndPassword(email, password);
                errorEl.textContent = '';
            } catch (error) {
                errorEl.textContent = '×©×’×™××”: ' + error.message;
            }
        }

        async function signOut() {
            await auth.signOut();
            data = {};
            currentMonth = '';
            clearForms();
        }

        async function loadDataFromFirebase() {
            if (!currentUser) return;
            
            updateSyncStatus('syncing', 'â³ ×˜×•×¢×Ÿ × ×ª×•× ×™×...');
            
            try {
                const docRef = db.collection('users').doc(currentUser.uid);
                const doc = await docRef.get();
                
                if (doc.exists) {
                    data = doc.data().financialData || {};
                    updateMonthSelect();
                    updateSyncStatus('synced', `âœ… ××—×•×‘×¨ ×›-${currentUser.email}`);
                } else {
                    data = {};
                    updateSyncStatus('synced', `âœ… ××—×•×‘×¨ ×›-${currentUser.email}`);
                }
            } catch (error) {
                console.error("Error loading data:", error);
                updateSyncStatus('error', 'âŒ ×©×’×™××” ×‘×˜×¢×™× ×ª × ×ª×•× ×™×');
            }
        }

        async function saveDataToFirebase() {
            if (!currentUser) return;
            
            updateSyncStatus('syncing', 'â³ ×©×•××¨...');
            
            try {
                await db.collection('users').doc(currentUser.uid).set({
                    financialData: data,
                    lastUpdated: firebase.firestore.FieldValue.serverTimestamp()
                });
                updateSyncStatus('synced', `âœ… × ×©××¨ ×‘×¢× ×Ÿ`);
                setTimeout(() => {
                    updateSyncStatus('synced', `âœ… ××—×•×‘×¨ ×›-${currentUser.email}`);
                }, 2000);
            } catch (error) {
                console.error("Error saving data:", error);
                updateSyncStatus('error', 'âŒ ×©×’×™××” ×‘×©××™×¨×”');
            }
        }

        function initializeYearSelect() {
            const yearSelect = document.getElementById('yearSelect');
            const currentYear = new Date().getFullYear();
            
            for (let year = currentYear; year >= 2020; year--) {
                const option = document.createElement('option');
                option.value = year;
                option.textContent = year;
                yearSelect.appendChild(option);
            }
        }

        function showContent() {
            document.getElementById('mainContent').style.display = 'block';
        }

        function hideContent() {
            document.getElementById('mainContent').style.display = 'none';
        }

        function addExpenseEntry(category, amount = '', description = '', entryId = null) {
            if (!entryId) {
                entryId = 'entry-' + Date.now() + '-' + Math.random().toString(36).substr(2, 9);
            }

            const container = document.getElementById(category + '-entries');
            const entryDiv = document.createElement('div');
            entryDiv.className = 'expense-entry';
            entryDiv.id = entryId;
            
            entryDiv.innerHTML = `
                <div class="expense-entry-header">
                    <span style="font-weight: bold; color: #667eea;">×”×•×¦××” ${container.children.length + 1}</span>
                    <button class="remove-btn" onclick="removeExpenseEntry('${category}', '${entryId}')">ğŸ—‘ï¸ ××—×§</button>
                </div>
                <div class="form-group">
                    <label>×¡×›×•× (â‚ª)</label>
                    <input type="number" class="expense-amount" data-category="${category}" value="${amount}" placeholder="×”×›× ×¡ ×¡×›×•×" onchange="updateCategoryTotal('${category}')">
                </div>
                <div class="form-group">
                    <label>×ª×™××•×¨</label>
                    <textarea class="expense-description" placeholder="×ª×™××•×¨ ×”×”×•×¦××”">${description}</textarea>
                </div>
            `;
            
            container.appendChild(entryDiv);
            updateCategoryTotal(category);
        }

        function removeExpenseEntry(category, entryId) {
            const entry = document.getElementById(entryId);
            if (entry) {
                entry.remove();
                updateCategoryTotal(category);
                const container = document.getElementById(category + '-entries');
                Array.from(container.children).forEach((child, index) => {
                    const header = child.querySelector('.expense-entry-header span');
                    if (header) {
                        header.textContent = `×”×•×¦××” ${index + 1}`;
                    }
                });
            }
        }

        function updateCategoryTotal(category) {
            const container = document.getElementById(category + '-entries');
            const amounts = container.querySelectorAll('.expense-amount');
            let total = 0;
            
            amounts.forEach(input => {
                total += parseFloat(input.value) || 0;
            });
            
            const totalElement = document.getElementById(category + '-total');
            if (totalElement) {
                totalElement.textContent = `×¡×”"×›: â‚ª${total.toLocaleString()}`;
            }
        }

        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');

            if (tabName === 'dashboard') {
                updateDashboard();
            }
        }

        function updateMonthSelect() {
            const select = document.getElementById('monthSelectDropdown');
            select.innerHTML = '<option value="">-- ×‘×—×¨ ×—×•×“×© ×§×™×™× --</option>';
            
            Object.keys(data).sort().reverse().forEach(monthKey => {
                const option = document.createElement('option');
                option.value = monthKey;
                const [year, month] = monthKey.split('-');
                option.textContent = `${monthNames[month]} ${year}`;
                select.appendChild(option);
            });
        }

        function addNewMonth() {
            const year = document.getElementById('yearSelect').value;
            const month = document.getElementById('monthSelect').value;
            
            if (!year || !month) {
                alert('×× × ×‘×—×¨ ×©× ×” ×•×—×•×“×©');
                return;
            }
            
            const newMonthKey = `${year}-${month}`;
            
            if (data[newMonthKey]) {
                alert('×—×•×“×© ×–×” ×›×‘×¨ ×§×™×™× ×‘××¢×¨×›×ª');
                currentMonth = newMonthKey;
                document.getElementById('monthSelectDropdown').value = newMonthKey;
                loadMonthData();
                showContent();
                return;
            }
            
            currentMonth = newMonthKey;
            data[currentMonth] = {
                income: {},
                expenses: {}
            };
            
            saveDataToFirebase();
            updateMonthSelect();
            document.getElementById('monthSelectDropdown').value = newMonthKey;
            document.getElementById('yearSelect').value = '';
            document.getElementById('monthSelect').value = '';
            
            loadMonthData();
            showContent();
            alert(`×—×•×“×© ${monthNames[month]} ${year} × ×•×¦×¨ ×‘×”×¦×œ×—×”!`);
        }

        function updateMonth() {
            currentMonth = document.getElementById('monthSelectDropdown').value;
            if (currentMonth) {
                loadMonthData();
                showContent();
            } else {
                clearForms();
                hideContent();
            }
        }

        function loadMonthData() {
            if (!currentMonth || !data[currentMonth]) return;

            const monthData = data[currentMonth];
            
            if (monthData.income) {
                document.getElementById('income-balance').value = monthData.income.balance || '';
                document.getElementById('income-balance-desc').value = monthData.income.balanceDesc || '';
                document.getElementById('income-salary').value = monthData.income.salary || '';
                document.getElementById('income-salary-desc').value = monthData.income.salaryDesc || '';
                document.getElementById('income-other').value = monthData.income.other || '';
                document.getElementById('income-other-desc').value = monthData.income.otherDesc || '';
            }

            expenseCategories.forEach(category => {
                const container = document.getElementById(category + '-entries');
                if (container) container.innerHTML = '';
            });

            if (monthData.expenses) {
                expenseCategories.forEach(category => {
                    if (monthData.expenses[category] && Array.isArray(monthData.expenses[category])) {
                        monthData.expenses[category].forEach(entry => {
                            addExpenseEntry(category, entry.amount, entry.description, entry.id);
                        });
                    }
                });
            }

            expenseCategories.forEach(category => {
                updateCategoryTotal(category);
            });
        }

        function clearForms() {
            document.querySelectorAll('input[type="number"], textarea').forEach(input => {
                input.value = '';
            });
            
            expenseCategories.forEach(category => {
                const container = document.getElementById(category + '-entries');
                if (container) container.innerHTML = '';
                updateCategoryTotal(category);
            });
        }

        async function saveIncome() {
            if (!currentMonth) {
                alert('×× × ×‘×—×¨ ×—×•×“×© ×ª×—×™×œ×”');
                return;
            }

            if (!data[currentMonth]) {
                data[currentMonth] = { income: {}, expenses: {} };
            }

            data[currentMonth].income = {
                balance: parseFloat(document.getElementById('income-balance').value) || 0,
                balanceDesc: document.getElementById('income-balance-desc').value,
                salary: parseFloat(document.getElementById('income-salary').value) || 0,
                salaryDesc: document.getElementById('income-salary-desc').value,
                other: parseFloat(document.getElementById('income-other').value) || 0,
                otherDesc: document.getElementById('income-other-desc').value
            };

            await saveDataToFirebase();
            updateMonthSelect();
            alert('×”×›× ×¡×•×ª × ×©××¨×• ×‘×”×¦×œ×—×”!');
        }

        async function saveExpenses() {
            if (!currentMonth) {
                alert('×× × ×‘×—×¨ ×—×•×“×© ×ª×—×™×œ×”');
                return;
            }

            if (!data[currentMonth]) {
                data[currentMonth] = { income: {}, expenses: {} };
            }

            data[currentMonth].expenses = {};

            expenseCategories.forEach(category => {
                const container = document.getElementById(category + '-entries');
                const entries = [];
                
                Array.from(container.children).forEach(entryDiv => {
                    const amount = entryDiv.querySelector('.expense-amount').value;
                    const description = entryDiv.querySelector('.expense-description').value;
                    
                    if (amount && parseFloat(amount) > 0) {
                        entries.push({
                            id: entryDiv.id,
                            amount: parseFloat(amount),
                            description: description
                        });
                    }
                });
                
                if (entries.length > 0) {
                    data[currentMonth].expenses[category] = entries;
                }
            });

            await saveDataToFirebase();
            updateMonthSelect();
            alert('×”×•×¦××•×ª × ×©××¨×• ×‘×”×¦×œ×—×”!');
        }

        let pieChart = null;
        let barChart = null;

        function updateDashboard() {
            if (!currentMonth || !data[currentMonth]) {
                alert('××™×Ÿ × ×ª×•× ×™× ×œ×”×¦×’×”. ×× × ×‘×—×¨ ×—×•×“×© ×¢× × ×ª×•× ×™×.');
                return;
            }

            const monthData = data[currentMonth];
            
            const totalIncome = (monthData.income?.balance || 0) + 
                               (monthData.income?.salary || 0) + 
                               (monthData.income?.other || 0);

            let totalExpenses = 0;
            const expensesByCategory = {};

            expenseCategories.forEach(category => {
                let categoryTotal = 0;
                if (monthData.expenses[category] && Array.isArray(monthData.expenses[category])) {
                    monthData.expenses[category].forEach(entry => {
                        categoryTotal += entry.amount || 0;
                    });
                }
                if (categoryTotal > 0) {
                    expensesByCategory[category] = categoryTotal;
                    totalExpenses += categoryTotal;
                }
            });
            
            const balance = totalIncome - totalExpenses;

            const summaryHTML = `
                <div class="summary-card">
                    <h4>×¡×š ×”×›× ×¡×•×ª</h4>
                    <div class="amount">â‚ª${totalIncome.toLocaleString()}</div>
                </div>
                <div class="summary-card" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                    <h4>×¡×š ×”×•×¦××•×ª</h4>
                    <div class="amount">â‚ª${totalExpenses.toLocaleString()}</div>
                </div>
                <div class="summary-card" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                    <h4>×™×ª×¨×”</h4>
                    <div class="amount">â‚ª${balance.toLocaleString()}</div>
                </div>
            `;
            document.getElementById('summaryCards').innerHTML = summaryHTML;

            const monthsHTML = Object.keys(data).sort().reverse().map(monthKey => {
                const [year, month] = monthKey.split('-');
                return `<div class="month-badge">${monthNames[month]} ${year}</div>`;
            }).join('');
            document.getElementById('monthsList').innerHTML = monthsHTML;

            const expenseLabels = {
                'amex-fastfood': '××–×•×Ÿ ××”×™×¨ (×××§×¡)',
                'amex-fashion': '×‘×’×“×™× ×•××•×¤× ×” (×××§×¡)',
                'amex-regular': '×§× ×™×•×ª ×¨×’×™×œ×•×ª (×××§×¡)',
                'amex-entertainment': '×™×¦×™××•×ª ×•×‘×™×œ×•×™×™× (×××§×¡)',
                'amex-car': '×ª×©×œ×•××™ ×¨×›×‘ (×××§×¡)',
                'amex-insurance': '×‘×™×˜×•×—×™× (×××§×¡)',
                'amex-subscriptions': '×©×™×¨×•×ª×™× ×•××™× ×•×™×™× (×××§×¡)',
                'amex-other': '××—×¨ (×××§×¡)',
                'mastercard-fastfood': '××–×•×Ÿ ××”×™×¨ (×××¡×˜×¨×§××¨×“)',
                'mastercard-fashion': '×‘×’×“×™× ×•××•×¤× ×” (×××¡×˜×¨×§××¨×“)',
                'mastercard-regular': '×§× ×™×•×ª ×¨×’×™×œ×•×ª (×××¡×˜×¨×§××¨×“)',
                'mastercard-entertainment': '×™×¦×™××•×ª ×•×‘×™×œ×•×™×™× (×××¡×˜×¨×§××¨×“)',
                'mastercard-car': '×ª×©×œ×•××™ ×¨×›×‘ (×××¡×˜×¨×§××¨×“)',
                'mastercard-insurance': '×‘×™×˜×•×—×™× (×××¡×˜×¨×§××¨×“)',
                'mastercard-subscriptions': '×©×™×¨×•×ª×™× ×•××™× ×•×™×™× (×××¡×˜×¨×§××¨×“)',
                'mastercard-other': '××—×¨ (×××¡×˜×¨×§××¨×“)',
                'assets-education': '×”×©×›×œ×” ×•××§×¦×•×¢',
                'assets-investments': '×”×©×§×¢×•×ª ×©×•×§ ×”×”×•×Ÿ',
                'assets-savings': '×—×¡×›×•× ×•×ª ×™×–×•××™×',
                'assets-equipment': '×¦×™×•×“ ×©×©×•××¨ ×¢×œ ×¢×¨×š',
                'assets-gym': '×—×“×¨ ×›×•×©×¨'
            };

            const pieData = [];
            const pieLabels = [];
            Object.keys(expensesByCategory).forEach(key => {
                if (expensesByCategory[key] > 0) {
                    pieLabels.push(expenseLabels[key] || key);
                    pieData.push(expensesByCategory[key]);
                }
            });

            if (pieChart) pieChart.destroy();
            if (barChart) barChart.destroy();

            const pieCtx = document.getElementById('pieChart').getContext('2d');
            pieChart = new Chart(pieCtx, {
                type: 'pie',
                data: {
                    labels: pieLabels,
                    datasets: [{
                        data: pieData,
                        backgroundColor: [
                            '#667eea', '#764ba2', '#f093fb', '#f5576c',
                            '#4facfe', '#00f2fe', '#43e97b', '#38f9d7',
                            '#fa709a', '#fee140', '#30cfd0', '#330867',
                            '#ff6b6b', '#4ecdc4', '#45b7d1', '#96ceb4',
                            '#ffeaa7', '#dfe6e9', '#74b9ff', '#a29bfe'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'right',
                            rtl: true,
                            labels: { font: { size: 12 } }
                        }
                    }
                }
            });

            const barCtx = document.getElementById('barChart').getContext('2d');
            barChart = new Chart(barCtx, {
                type: 'bar',
                data: {
                    labels: ['×”×›× ×¡×•×ª', '×”×•×¦××•×ª'],
                    datasets: [{
                        label: '×¡×›×•× (â‚ª)',
                        data: [totalIncome, totalExpenses],
                        backgroundColor: [
                            'rgba(102, 126, 234, 0.8)',
                            'rgba(245, 87, 108, 0.8)'
                        ],
                        borderColor: [
                            'rgba(102, 126, 234, 1)',
                            'rgba(245, 87, 108, 1)'
                        ],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    scales: { y: { beginAtZero: true } },
                    plugins: { legend: { display: false } }
                }
            });

            let detailsHTML = '<h3 style="color: #667eea; margin: 20px 0;">×¤×™×¨×•×˜ ×”×•×¦××•×ª</h3>';
            
            expenseCategories.forEach(category => {
                if (monthData.expenses[category] && Array.isArray(monthData.expenses[category]) && monthData.expenses[category].length > 0) {
                    const categoryLabel = expenseLabels[category] || category;
                    const categoryTotal = expensesByCategory[category] || 0;
                    
                    detailsHTML += `
                        <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 20px 0;">
                            <h4 style="color: #667eea; margin-bottom: 15px;">${categoryLabel} - ×¡×”"×›: â‚ª${categoryTotal.toLocaleString()}</h4>
                    `;
                    
                    monthData.expenses[category].forEach((entry, index) => {
                        detailsHTML += `
                            <div class="expense-item" style="margin: 10px 0;">
                                <div>
                                    <strong>×”×•×¦××” ${index + 1}</strong>
                                    ${entry.description ? `<p style="margin: 5px 0; color: #666;">${entry.description}</p>` : ''}
                                </div>
                                <span style="font-size: 1.2em; font-weight: bold;">â‚ª${entry.amount.toLocaleString()}</span>
                            </div>
                        `;
                    });
                    
                    detailsHTML += `</div>`;
                }
            });
            
            document.getElementById('expenseDetails').innerHTML = detailsHTML;
        }

        // Initialize
        initializeYearSelect();
    </script>
</body>
</html>